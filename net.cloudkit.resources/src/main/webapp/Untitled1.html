<!doctype html>
<html lang="en">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta charset="utf-8" />
    <meta name="referrer" content="always" />
    <title>text-editor</title>
    <style rel="stylesheet" type="text/css">
        .editor-view {
            background: #000000;
            cursor: text;
            width: 1000px;
            color: #f1f1f1;
            padding: 8px;
        }

        .text-input {
            padding: 0px;
            width: 1000px;
            height: 1em;
            outline: none;
            border: 0;
        }
    </style>

</head>
<body>

<div id="text-editor">
    <textarea class="text-input" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0">
        ss
    </textarea>
    <div class="editor-view">Hello!</div>
</div>

<!--
<input type="button" id="b1" value="获取value" onclick="alert(document.getElementById('b1').value)" />
<input type="button" id="b2" value="获取innerHTML" onclick="alert(document.getElementById('b2').innerHTML)" />
-->

<script type="text/javascript">

    var textEditor = document.getElementById("text-editor")
    var textInput = textEditor.getElementsByClassName("text-input")[0];
    textInput.addEventListener("keyup", function () {

        // alert(textInput.value);
        var viewText = "";
        var texts = textInput.value.split("\n");
        for(var i = 0; i < texts.length; i ++) {
            viewText += "<div><span>" + (i+1) + "</span>" + texts[i] + "</div>";
        }
        textEditor.getElementsByClassName("editor-view")[0].innerHTML = viewText;
    }, false);
    go(10);


    function go(line) {
        textInput.focus();
        var v = textInput.value.split("\n");
        ch = 0;
        for(var i=0; i<line-1; i++) {
            ch += v[i].length;
        }
        var o = textInput.createTextRange();
        o.move("character", ch);
        o.select();
    }
</script>
</body>
</html>
